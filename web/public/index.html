<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goal Reminder Bot</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3b82f6">
  <style>
    body.dark {
      background-color: #1a202c;
      color: #f7fafc;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen flex flex-col items-center p-4">
  <audio id="bg-music" src="/media/bg.mp3" loop></audio>
  <audio id="ding" src="/media/ding.mp3"></audio>

  <div class="fixed top-4 right-4 flex gap-2">
    <button id="musicToggle" class="bg-blue-700 text-white px-3 py-1 rounded">ðŸ”Š</button>
    <button id="darkToggle" class="bg-black text-white px-3 py-1 rounded">ðŸŒ™</button>
    <a href="/history.html" class="bg-gray-700 text-white px-3 py-1 rounded">ðŸ“œ History</a>
  </div>

  <h1 class="text-3xl font-bold mb-4 mt-8">ðŸŽ¯ Goal Reminder Bot</h1>

  <div id="quote" class="italic text-center text-sm text-gray-600 mb-4"></div>

  <!-- UI remains same, trimmed for brevity -->

  <script>
    // Music toggle
    const music = document.getElementById('bg-music');
    let musicPlaying = false;
    document.getElementById('musicToggle').onclick = () => {
      musicPlaying ? music.pause() : music.play();
      musicPlaying = !musicPlaying;
    };

    // Dark mode
    document.getElementById('darkToggle').onclick = () => document.body.classList.toggle('dark');

    // Notifications
    function notify(title, body) {
      if (Notification.permission === 'granted') {
        new Notification(title, { body });
      }
    }

    // Load goals
    async function completeGoal(id) {
      await fetch(`/api/goals/${id}/complete`, { method: 'PATCH' });
      document.getElementById('ding').play();
      notify('ðŸŽ‰ Goal Completed!', 'You completed a goal!');
      loadGoals();
    }

    // Request notification permission
    if ("Notification" in window) {
      Notification.requestPermission();
    }

    // PWA install
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').then(() => console.log("âœ… Service worker registered"));
    }
  </script>
</body>
</html>
